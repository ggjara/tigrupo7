<% content_for :header do %>
    <h1>OCs Recibidas</h1>
<%end%>

<% content_for :content do %>
    <!-- Default box -->
    <% @grupo = Cliente.find_by(grupo: 7)._idGrupo %>
    <div class="box collapsed-box">
      <div class="box-header with-border">
        <h3 class="box-title">Creadas (<%= Oc.all.where(:proveedor => @grupo, :estado => "creada").count %>)</h3>
        <div class="box-tools pull-right">
          <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="" data-original-title="Collapse">
            <i class="fa fa-plus"></i></button>
        </div>
      </div>
      <div class="box-body">
        <table class="table table-hover search-table">
          <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Canal</th>
            <th>SKU</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Estado</th>
            <th align="center">Documentos Asociados</th>
          </tr>
          </thead>
          <tbody>
          <% @oc_recibidas.where(:estado => "creada").each do |oc| %>
              <tr>
                <td><%= oc._id %></td>
                <td><%= oc.cliente %></td>
                <td><%=oc.canal %></td>
                <td><%= oc.sku %></td>
                <td><%= oc.cantidad %></td>
                <td><%= oc.precioUnitario %></td>
                <td><%= oc.estado %></td>
                <td align="center">
                  <% if oc.facturaRealizadaDB == true %>
                  <% if Factura.find_by(:id_Oc => oc._id)!=nil %>
                      <%= link_to raw('<i class="fa fa-pencil-square-o fa-fw" ></i>'), "/facturas/"+ Factura.find_by(:id_Oc => oc._id)._id.to_s,
                                  method: :get, class: 'btn btn-xs btn-warning',
                                  data: { toggle: 'tooltip', placement: 'top' }, title: 'Ver' %>
                  <% end %> 
                  <% end %>
                </td>
                <td></td>
              </tr>
          <% end %>
          </tbody>
        </table>
      </div><!-- /.box-body -->
      <div class="box-footer">
      </div><!-- /.box-footer-->
    </div><!-- /.box -->

    <div class="box collapsed-box">
      <div class="box-header with-border">
        <h3 class="box-title">Aceptadas (<%= Oc.all.where(:proveedor => @grupo, :estado => "aceptada").count %>)</h3>
        <div class="box-tools pull-right">
          <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="" data-original-title="Collapse">
            <i class="fa fa-plus"></i></button>
        </div>
      </div>
      <div class="box-body">
        <table class="table table-hover search-table">
          <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Canal</th>
            <th>SKU</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Estado</th>
            <th>Documentos Asociados</th>
          </tr>
          </thead>
          <tbody>
          <% @oc_recibidas.where(:estado => "aceptada").each do |oc| %>
              <tr>
                <td><%= oc._id %></td>
                <td><%= oc.cliente %></td>
                <td><%=oc.canal %></td>
                <td><%= oc.sku %></td>
                <td><%= oc.cantidad %></td>
                <td><%= oc.precioUnitario %></td>
                <td><%= oc.estado %></td>
                <td align="center">
                  <% if oc.facturaRealizadaDB == true %>
                  <% if Factura.find_by(:id_Oc => oc._id)!=nil %>
                      <%= link_to raw('<i class="fa fa-pencil-square-o fa-fw" ></i>'), "/facturas/"+ Factura.find_by(:id_Oc => oc._id)._id.to_s,
                                  method: :get, class: 'btn btn-xs btn-warning',
                                  data: { toggle: 'tooltip', placement: 'top' }, title: 'Ver' %>
                  <% end %>
                  <% end %>
                </td>
                <td></td>
              </tr>
          <% end %>
          </tbody>
        </table>
      </div><!-- /.box-body -->
      <div class="box-footer">
      </div><!-- /.box-footer-->
    </div><!-- /.box -->

    <div class="box collapsed-box">
      <div class="box-header with-border">
        <h3 class="box-title">Rechazadas (<%= Oc.all.where(:proveedor => @grupo, :estado => "rechazada").count %>)</h3>
        <div class="box-tools pull-right">
          <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="" data-original-title="Collapse">
            <i class="fa fa-plus"></i></button>
        </div>
      </div>
      <div class="box-body">
        <table class="table table-hover search-table">
          <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Canal</th>
            <th>SKU</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Estado</th>
            <th>Documentos Asociados</th>
          </tr>
          </thead>
          <tbody>
          <% @oc_recibidas.where(:estado => "rechazada").each do |oc| %>
              <tr>
                <td><%= oc._id %></td>
                <td><%= oc.cliente %></td>
                <td><%=oc.canal %></td>
                <td><%= oc.sku %></td>
                <td><%= oc.cantidad %></td>
                <td><%= oc.precioUnitario %></td>
                <td><%= oc.estado %></td>
                <td align="center">
                  <% if oc.facturaRealizadaDB == true %>
                  <% if Factura.find_by(:id_Oc => oc._id)!=nil %>
                      <%= link_to raw('<i class="fa fa-pencil-square-o fa-fw" ></i>'), "/facturas/"+ Factura.find_by(:id_Oc => oc._id)._id.to_s,
                                  method: :get, class: 'btn btn-xs btn-warning',
                                  data: { toggle: 'tooltip', placement: 'top' }, title: 'Ver' %>
                  <% end %>
                  <% end %>
                </td>
                <td></td>
              </tr>
          <% end %>
          </tbody>
        </table>
      </div><!-- /.box-body -->
      <div class="box-footer">
      </div><!-- /.box-footer-->
    </div><!-- /.box -->

    <div class="box collapsed-box">
      <div class="box-header with-border">
        <h3 class="box-title">Finalizadas (<%= Oc.all.where(:proveedor => @grupo, :estado => "finalizada").count %>) </h3>
        <div class="box-tools pull-right">
          <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="" data-original-title="Collapse">
            <i class="fa fa-plus"></i></button>
        </div>
      </div>
      <div class="box-body">
        <table class="table table-hover search-table">
          <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Canal</th>
            <th>SKU</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Estado</th>
            <th>Documentos Asociados</th>
          </tr>
          </thead>
          <tbody>
          <% @oc_recibidas.where(:estado => "finalizada").each do |oc| %>
              <tr>
                <td><%= oc._id %></td>
                <td><%= oc.cliente %></td>
                <td><%=oc.canal %></td>
                <td><%= oc.sku %></td>
                <td><%= oc.cantidad %></td>
                <td><%= oc.precioUnitario %></td>
                <td><%= oc.estado %></td>
                <td align="center">
                  <% if oc.facturaRealizadaDB == true %>
                  <% if Factura.find_by(:id_Oc => oc._id)!=nil %>
                      <%= link_to raw('<i class="fa fa-pencil-square-o fa-fw" ></i>'), "/facturas/"+ Factura.find_by(:id_Oc => oc._id)._id.to_s,
                                  method: :get, class: 'btn btn-xs btn-warning',
                                  data: { toggle: 'tooltip', placement: 'top' }, title: 'Ver' %>
                  <% end %>
                  <% end %>
                </td>
                <td></td>
              </tr>
          <% end %>
          </tbody>
        </table>
      </div><!-- /.box-body -->
      <div class="box-footer">
      </div><!-- /.box-footer-->
    </div><!-- /.box -->

    <div class="box collapsed-box">
      <div class="box-header with-border">
        <h3 class="box-title">Anuladas (<%= Oc.all.where(:proveedor => @grupo, :estado => "anulada").count %>)</h3>
        <div class="box-tools pull-right">
          <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="" data-original-title="Collapse">
            <i class="fa fa-plus"></i></button>
        </div>
      </div>
      <div class="box-body">
        <table class="table table-hover search-table">
          <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Canal</th>
            <th>SKU</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Estado</th>
            <th>Documentos Asociados</th>
          </tr>
          </thead>
          <tbody>
          <% @oc_recibidas.where(:estado => "anulada").each do |oc| %>
              <tr>
                <td><%= oc._id %></td>
                <td><%= oc.cliente %></td>
                <td><%=oc.canal %></td>
                <td><%= oc.sku %></td>
                <td><%= oc.cantidad %></td>
                <td><%= oc.precioUnitario %></td>
                <td><%= oc.estado %></td>
                <td align="center">
                  <% if oc.facturaRealizadaDB == true %>
                  <% if Factura.find_by(:id_Oc => oc._id)!=nil %>
                      <%= link_to raw('<i class="fa fa-pencil-square-o fa-fw" ></i>'), "/facturas/"+ Factura.find_by(:id_Oc => oc._id)._id.to_s,
                                  method: :get, class: 'btn btn-xs btn-warning',
                                  data: { toggle: 'tooltip', placement: 'top' }, title: 'Ver' %>
                  <% end %>
                  <% end %>
                </td>
                <td></td>
              </tr>
          <% end %>
          </tbody>
        </table>
      </div><!-- /.box-body -->
      <div class="box-footer">
      </div><!-- /.box-footer-->
    </div><!-- /.box -->

<%end%>